# dataset settings
dataset_type = 'C2SegDataset'
data_root = 'data/c2seg_ab'
img_norm_cfg = dict(
    mean=(
        [682.82222806, 904.15837662, 855.63069818, 2714.78353602],
        [495.71776807,  512.13764166,  525.48311092,  543.50339852,
        558.89870489,  557.2857751 ,  556.20477831,  558.91850577,
        551.73300137,  545.05334875,  551.36638935,  567.25314789,
        570.56216308,  571.58490661,  574.26098879,  587.66983759,
        601.93300576,  614.11762749,  636.11786403,  658.41335132,
        678.64433943,  717.19485194,  752.67943464,  778.14822712,
        794.74585006,  804.32143819,  816.67443333,  830.22288988,
        820.61828054,  812.9914676 ,  805.33517288,  799.5712202 ,
        801.71322934,  804.53249619,  802.67591472,  802.90907662,
        806.35470503,  804.46055161,  802.37299143,  801.86822398,
        800.58073565,  800.02541119,  798.3869336 ,  792.14082554,
        784.34031705,  782.06450879,  782.32792334,  788.27330872,
        804.91723387,  856.93157802,  974.96207794, 1118.46592137,
       1262.01464061, 1430.99920475, 1643.72793836, 1876.14069006,
       2068.64017271, 2229.13805839, 2287.64834964, 2306.99828051,
       2455.75576659, 2521.31951703, 2544.19851964, 2557.07443204,
       2557.48980109, 2553.27203101, 2589.55800665, 2611.1535184 ,
       2615.90788073, 2631.96044564, 2653.60103845, 2669.13890797,
       2675.68664305, 2681.73104803, 2683.23506472, 2673.23375012,
       2653.15780137, 2670.69600624, 2656.03886755, 2643.23305347,
       2574.38261352, 2547.47224421, 2508.83767242, 2437.57571422,
       2409.4952605 , 2596.4491955 , 2882.17187165, 2923.01410873,
       2668.14609089, 2650.827628  , 2614.16311075, 2548.41042722,
       2507.05509887, 2426.06927133, 2490.20052955, 2808.4654626 ,
       2916.31649322, 2904.6132153 , 2925.11567705, 2956.38882681,
       3006.03828268, 3019.21171531, 3039.97036888, 3096.13488345,
       3103.68041165, 3063.93380122, 3025.70570413, 2854.4815296 ,
       2925.73333137, 3305.67635046, 3046.24479144, 3052.93001392,
       2841.84722274, 2728.3053097 , 2723.5095387 , 2722.68455466,
       2767.1211407 , 2790.66483002, 2801.73546022, 2790.71450057,
       2790.97902403, 2860.87948083, 2826.39771514, 2761.01463882,
       2684.08281509, 2573.08619528, 2430.09037965, 1953.32598855,
       1810.18913565, 1803.16030112, 1797.7947229 , 1792.42970382,
       1787.0665272 , 1783.23203621, 1825.38242907, 1882.86620825,
       1759.06614557, 1580.6995123 , 1694.75388099, 1713.8644787 ,
       1647.16316486, 1656.78552447, 1692.93488063, 1723.65147137,
       1760.02857876, 1778.59800189, 1779.69582269, 1815.94697856,
       1841.88914697, 1876.69414434, 1939.26790365, 1949.8482628 ,
       1959.51185267, 1982.47224242, 1983.29451274, 1988.2452444 ,
       2003.68053819, 1984.48959943, 1950.07962137, 1922.05910573,
       1896.94868218, 1886.50922123, 1899.26734874, 1860.40273925,
       1821.15297176, 1774.79184508, 1742.97273428, 1685.15020506,
       1651.04508553, 1812.6139826 , 1838.48606342, 1809.08319561,
       1778.68176135, 1748.28197214, 1717.88027384, 1687.47932585,
       1657.07992923, 1629.71705756, 1599.319953  , 1568.9158636 ,
       1541.55619572, 1511.15660816, 1480.75530782, 1453.39424351,
       1422.27664151, 1383.43924498, 1337.536256  , 1178.98262443,
       1039.18334156, 1272.43749352, 1472.14854124, 1483.9919134 ,
       1338.63676972, 1240.37875489, 1248.65730369, 1320.29702971,
       1387.0416461 , 1385.89710881, 1367.53535568, 1380.49627216,
       1367.5498418 , 1362.59742821, 1379.48406133, 1380.47364734,
       1377.79504104, 1400.07389457, 1425.91081959, 1454.41221669,
       1432.17547093, 1422.53983561, 1394.90176693, 1400.24551157,
       1420.3827385 , 1422.48913977, 1420.51037799, 1399.55076471,
       1361.34008118, 1320.25171927, 1295.50717331, 1287.99488803,
       1265.27890406, 1237.37698107, 1226.24338652, 1226.31410413,
       1189.78705594, 1140.09534407, 1168.37958658, 1125.28969141,
       1108.35450806, 1124.67528894, 1181.82252385, 1101.96479233,
       1101.07259003, 1086.24732295, 1121.65845218, 1129.53569819,
       1069.78764774, 1044.67557936, 1172.49391638, 1182.09920136,
       1101.87539103, 1094.29255224],
        [-15.95828888,  -9.10781506]),
    std=(
        [261.79564319, 259.42994617, 347.27061045, 669.84461932],
        [238.19456327, 245.88407955, 251.98017214, 260.25018328,
       267.13526867, 267.77912458, 268.48322692, 270.98225459,
       269.64233081, 268.63654995, 272.49811071, 280.06705779,
       282.6428625 , 283.93291174, 285.31747128, 289.84671123,
       292.93578549, 292.43359497, 292.22993729, 287.97505409,
       280.17544589, 279.15535913, 279.68845458, 281.58250764,
       282.8464278 , 282.74692374, 285.6355605 , 292.91459659,
       296.88819412, 304.68413324, 315.10971828, 322.04071896,
       330.77050174, 337.34945594, 339.483528  , 343.25708177,
       350.39576318, 356.75455932, 361.77870962, 364.89933338,
       366.78986843, 371.86369039, 379.5980889 , 385.5725036 ,
       388.58601857, 395.84745258, 400.60881427, 403.25294178,
       399.2516256 , 390.08396249, 365.87280501, 330.20609443,
       304.5275749 , 305.47425934, 348.75771074, 427.32314409,
       511.66856461, 591.52552623, 629.60716672, 649.05967791,
       692.61295423, 710.79296428, 717.63375248, 721.66707523,
       722.3707782 , 721.3234623 , 730.10804467, 736.3013448 ,
       738.43188606, 744.5274046 , 751.97751106, 757.71872097,
       761.22933208, 762.7155824 , 763.14321365, 760.63928956,
       753.70659115, 756.96375621, 752.45807471, 748.26458515,
       731.96103866, 735.50261723, 719.13513151, 692.55287333,
       668.94351591, 673.67901493, 708.34262763, 719.304329  ,
       756.14287944, 750.75516054, 740.94281703, 732.56288639,
       718.74457518, 686.07858555, 669.63443   , 697.18457201,
       718.34459208, 721.19303946, 733.52145992, 749.00641981,
       769.40088497, 779.07176402, 788.1177729 , 805.01574583,
       805.44965188, 788.92078284, 767.58676258, 706.7453835 ,
       692.89555436, 755.88375818, 665.66426798, 651.15000841,
       604.33124428, 577.74581443, 574.1405787 , 573.41095949,
       584.22348736, 591.55472745, 596.60779095, 596.14817246,
       596.43178876, 609.4995992 , 597.7597347 , 577.04219062,
       552.26496039, 521.02112255, 488.88460783, 390.53656086,
       369.53623279, 386.57043193, 415.36884566, 452.36780177,
       495.72812647, 544.09264979, 601.21926313, 654.69018351,
       650.43489936, 584.96549381, 618.53437966, 609.92021037,
       565.41106472, 542.5758238 , 531.31763755, 516.95667068,
       508.28767219, 496.62605607, 480.72545045, 477.29259601,
       472.72495253, 471.29703413, 477.9487352 , 473.07602691,
       469.89175735, 471.35981524, 469.36170882, 469.59381215,
       473.64200911, 471.25575203, 466.57676273, 464.99820806,
       465.36598072, 469.26777395, 480.64847393, 480.226235  ,
       479.94044797, 476.79946625, 473.51927679, 458.3608351 ,
       450.49735943, 516.61395529, 538.53637658, 540.67707443,
       543.61520097, 547.71210829, 552.93704496, 559.26441086,
       566.6649061 , 574.21045168, 583.54796671, 593.8504302 ,
       603.90901673, 615.92431723, 628.77904807, 641.02724755,
       654.89403573, 659.80040661, 648.87525157, 567.29947404,
       477.22365285, 566.10190652, 663.36169461, 677.18955214,
       608.54197961, 557.21154443, 552.1952732 , 577.05982554,
       599.53542014, 592.56440395, 577.12458888, 574.73930617,
       562.63626421, 553.12632457, 552.36215646, 545.89433902,
       539.32243374, 542.04137283, 546.01897228, 551.47808787,
       537.24148909, 527.78911213, 511.32913932, 508.56449374,
       513.48546755, 514.38452576, 515.5049693 , 511.47734676,
       503.42382262, 494.5314157 , 492.58800739, 497.69689995,
       495.89894969, 491.03908248, 493.13766258, 500.75183171,
       492.96374555, 476.75936993, 491.99022837, 478.9365587 ,
       477.90146915, 490.93416096, 520.75472901, 490.02573873,
       493.43774102, 491.02731212, 512.07855475, 519.46643472,
       495.25354223, 484.46978068, 546.78123028, 558.63649659,
       523.17613864, 517.4477587],
       [3.92450751, 4.61980127]))
crop_size = (640, 640)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', reduce_zero_label=True),
    dict(type='Resize', img_scale=(2560, 640), ratio_range=(0.5, 2.0)),
    dict(type='RandomCrop', crop_size=crop_size, cat_max_ratio=0.75),
    dict(type='RandomFlip', prob=0.5),
    # dict(type='PhotoMetricDistortion'),
    dict(type='Normalize', **img_norm_cfg),
    dict(type='Pad', size=crop_size, pad_val=0, seg_pad_val=255),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_semantic_seg']),
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2560, 640),
        # img_ratios=[0.5, 0.75, 1.0, 1.25, 1.5, 1.75],
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(type='Normalize', **img_norm_cfg),
            dict(type='ImageToTensor', keys=['msi_img', 'hsi_img', 'sar_img']),
            dict(type='Collect', keys=['img',]),
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=8,
    train=dict(
        type=dataset_type,
        data_root=data_root,
        img_dir='img_dir/train',
        ann_dir='ann_dir/train',
        pipeline=train_pipeline),
    val=dict(
        type=dataset_type,
        data_root=data_root,
        img_dir='img_dir/val',
        ann_dir='ann_dir/val',
        pipeline=test_pipeline),
    test=dict(
        type=dataset_type,
        data_root=data_root,
        img_dir='img_dir/val',
        ann_dir='ann_dir/val',
        pipeline=test_pipeline))
